好的，这是一份可以直接交给数据处理团队的**特征工程详细需求表**。

我已经将你的想法和我的建议进行了整合，并按逻辑分为了五大类。请强调：**所有涉及“历史”的特征，都严禁使用“未来数据”（即计算第 T 周特征时，不能用到 T+1 周之后的信息）。**

### 2026 MCM Problem C - 特征工程需求表

#### 1. 选手静态特征 (Static Celebrity Features)
*用于捕捉名人的固有粉丝基础（Base Popularity）。*

| 字段名                | 类型  | 构造逻辑/说明                                                                                        | 备注                          |     |                                                |
| :----------------- | :-- | :--------------------------------------------------------------------------------------------- | :-------------------------- | --- | ---------------------------------------------- |
| `is_male`          | 0/1 | 名人为男性=1，女性=0                                                                                   | 核心人口统计学特征                   |     |                                                |
| `age`              | 数值  | 赛季开始时的年龄                                                                                       | 建议保留原始数值                    |     |                                                |
| `age_squared`      | 数值  | $Age^2$                                                                                        | 用于捕捉非线性关系（如：观众偏爱极年轻或极年长的选手） |     |                                                |
| `age_bucket_young` | 0/1 | Age < 25 (阈值可调)                                                                                | 独热编码 A                      |     |                                                |
| `age_bucket_mid`   | 0/1 | 25 <= Age <= 50                                                                                | 独热编码 B                      |     |                                                |
| `age_bucket_old`   | 0/1 | Age > 50                                                                                       | 独热编码 C                      |     |                                                |
| `industry_{Type}`  | 0/1 | 将 `celebrity_industry` 归类为 Top 5-7 类（如：Actor, Athlete, Singer, RealityStar, Host, Other）并做独热编码 | 需人工清洗 messy text            |     |                                                |
| `is_international` | 0/1 | `homecountry` 不是 "United States" = 1                                                           | 区分美国本土 vs 国际选手              |     |                                                |
| `log_us_state_pop` | 数值  | **仅当 `is_international` = 0 时**，填入选手所在州的 $log_{10}(\text{人口数})$。**若为国际选手，此项填 0。**              | **核心修正**：隔离美国选手的“州内基本盘”效应   |     | **关键**：若 `is_usa`=0，填原籍国人口；若数据缺失填均值。取对数防止数值爆炸。 |

对于 `age` 和 `age_squared`，必须进行中心化：
$$age_{centered} = age - \mu_{age}$$

#### 2. 职业舞者特征 (Pro Partner Features)
*用于捕捉“名师出高徒”效应及舞者自身的粉丝群。*

| 字段名 | 类型 | 构造逻辑/说明 | 备注 |
| :--- | :--- | :--- | :--- |
| `pro_id` | 索引 | 给每位职业舞者分配唯一 ID (1, 2, 3...) | 用于贝叶斯模型的**随机效应 (Random Effects)** |
| `pro_prev_wins` | 数值 | 该舞者在**本赛季之前**获得的冠军总次数 | 反映舞者的历史统治力 |
| `pro_avg_rank` | 数值 | 该舞者在**本赛季之前**的历史平均排名 | 若为新舞者，填所有舞者的平均值 |
| `same_sex_pair` | 0/1 | 名人与舞者性别相同 = 1 | 捕捉特殊组合的社会反响 |

#### 3. 动态表现特征 (Dynamic Performance Features)
*每周更新，用于反映当周的技术表现。*

| 字段名                  | 类型  | 构造逻辑/说明                                           | 备注                    |
| :------------------- | :-- | :------------------------------------------------ | :-------------------- |
| `z_score`            | 数值  | $\frac{\text{个人分} - \text{当周全员均分}}{\text{当周标准差}}$ | **核心特征**：跨赛季、跨周的可比表现分 |
| `score_trend`        | 数值  | $\text{本周 z_score} - \text{上周 z_score}$           | 第一周填 0；捕捉“进步”叙事       |
| `is_top_score`       | 0/1 | 本周 `raw_score` 为全场最高（或并列最高） = 1                   | 领跑者光环效应               |
| `perfect_score`      | 0/1 | 是否获得满分（如 30/30 或 40/40）                           | 满分表演通常有额外话题性          |
| `judge_score_stddev` | 数值  | 计算当周选手获得的所有评委评分的**标准差**                           | **新增**：量化评委间的“争议度”    |

#### 4. 存活与历史轨迹特征 (Survival & History)
*每周更新，用于捕捉“粉丝粘性”和“逆风翻盘”信号。*

| 字段名                    | 类型  | 构造逻辑/说明                       | 备注                         |
| :--------------------- | :-- | :---------------------------- | :------------------------- |
| `times_in_bottom`      | 数值  | 截止到本周前，累计进入“倒数两名”的次数          | 濒死次数越多，粉丝可能越疲劳             |
| `cumulative_avg_score` | 数值  | 截止到本周前的赛季平均分                  | 选手的整体实力定位                  |
| `teflon_factor`        | 0/1 | **上一周**评委分排倒数前2，但结果为 **Safe** | **最强特征**：得分为0但没死，说明该周粉丝票极高 |
| `weeks_survived`       | 数值  | 当前是第几周 (t)                    | 随着赛程深入，粉丝基础会固化             |

#### 5. 赛制与环境特征 (Context Features)
*用于控制模型在不同规则下的行为。*

| 字段名 | 类型 | 构造逻辑/说明 | 备注 |
| :--- | :--- | :--- | :--- |
| `season_era` | 类别/数值 | 1: 早期(S1-10), 2: 中期(S11-20), 3: 社媒期(S21+) | 也可以直接用 `season_id` |
| `rule_method` | 0/1 | 0 = 排名法 (Rank Method)<br>1 = 百分比法 (Percent Method) | **这不在回归中使用，但在似然函数计算淘汰逻辑时必选** |
| `judge_save_active` | 0/1 | 该赛季是否有“评委拯救环节” (通常 S28+) | 同样用于调整淘汰逻辑 |

---

### 给数据团队的额外处理提示 (Data Processing Tips)

1.  **缺失值处理 (N/A):**
    *   如果 `score` 是 N/A 且 `results` 显示已淘汰：直接在当周及之后的数据中移除该选手。
    *   如果 `score` 是 N/A 但选手未淘汰（如生病缺席）：通常按规则给最低分或均分，需查阅规则补充，或者标记一个 `missed_performance` 标志位。
2.  **数据标准化:**
    *   除 `z_score` 外，建议对人口对数 `log_home_pop` 和年龄 `age` 也进行标准化（减均值除方差），这对 MCMC 采样收敛非常有帮助。
3.  **最终输出格式:**
    *   我们需要一个 **Long Format (长格式)** 的表格。
    *   **主键:** `Season_ID`, `Week_ID`, `Celebrity_ID`。
    *   每一行代表：某位选手在某一周的状态。