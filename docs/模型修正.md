# 模型修正文档

本文档记录了分层贝叶斯模型中为解决各类问题而实施的修正措施。

---

## 1. 可识别性修正：和为零约束

### 问题描述
模型核心采用 Softmax 函数将潜在投票强度转换为得票占比。Softmax 具有**平移不变性**：对于任意常数 $C$，$\text{Softmax}(V) = \text{Softmax}(V+C)$。

若不加约束，名人效应 $\alpha$ 和舞者效应 $\delta$ 会在 MCMC 迭代中沿实数轴无限漂移，导致模型不可识别（Unidentifiability）。

### 修正方案
对 $\alpha$ 和 $\delta$ 施加**和为零约束**：

$$\sum_{i=1}^{N_{celebs}} \alpha_i = 0, \quad \sum_{j=1}^{N_{pros}} \delta_j = 0$$

这个之前的文档已经写了

---

## 2. 共线性修正：特征排除

### 问题描述
高度相关的特征会导致：
1. 系数估计不稳定（方差膨胀）
2. 系数方向反转（与预期相反）
3. MCMC 采样效率下降

### 修正方案
排除与其他特征高度相关的冗余特征。

### 排除的观测特征
| 特征 | 排除原因 |
|------|----------|
| `judge_save_active` | 与 `rule_method` 高度负相关 (r=-0.931) |
| `score_trend` | 与 `z_score` 共线性 (r=0.585)，导致系数反转 |
| `is_top_score` | 与 `z_score` 高度相关 (r=0.585)，系数方向不合理 |
| `perfect_score` | 与 `z_score` 相关 (r=0.283)，系数方向不合理 |

### 排除的名人特征
| 特征 | 排除原因 |
|------|----------|
| `age_centered` | 与 `age` 完全相同 (r=1.0)，冗余 |
| `age_squared` | 与 `age` 高度相关 (r=0.979) |
| `age_bucket_old` | 与 `age` 高度相关 (r=0.738) |

这里可以表述为：我们分析了特征之间的两两相关系数，排除了高度共线性的特征

---

## 3. 数据修正：均值中心化

我们对特征做中心化处理进一步消除共线性

---

## 4. 鲁棒性修正：Student-t 分布

### 问题描述
正态分布对异常值敏感。在"与星共舞"中存在：
- **爆冷淘汰**：高分选手意外出局
- **人气黑马**：低分选手凭借粉丝票存活

这些极端情况会严重干扰正态分布假设下的参数估计。

### 修正方案
将正态分布替换为**重尾的 Student-t 分布**，增强对离群值的容忍度。

### 应用位置
1. **名人效应噪声**：$\alpha_{eps} \sim \text{Student-t}(\nu_\alpha, 0, 1)$
2. **舞者效应噪声**：$\delta_{eps} \sim \text{Student-t}(\nu_\delta, 0, 1)$
3. **观测级噪声**：$\epsilon_{obs} \sim \text{Student-t}(\nu_{obs}, 0, \sigma_{obs})$

自由度 $\nu$ 可学习或固定，控制重尾程度。


---

## 5. 非线性交互修正：交互项支持

### 问题描述
单一特征无法捕捉复杂的交互效应，例如：
- 铁氟龙效应在濒死多次后可能减弱
- 分数的重要性在不同时代可能不同
- 舞者实力与当周表现的协同效应

### 修正方案
支持在配置中定义**特征交互项**，自动计算并加入模型。

### 当前交互项
| 交互项 | 含义 |
|--------|------|
| `teflon_factor * times_in_bottom` | 铁氟龙效应 × 濒死次数 |
| `pro_avg_rank * z_score` | 舞者历史排名 × 当周分数 |
| `z_score * cumulative_avg_score` | 当周分数 × 累积平均分 |
| `season_era * z_score` | 时代 × 当周分数（不同时代分数重要性不同） |


---

## 修正效果

| 修正 | 解决的问题 | 效果 |
|------|-----------|------|
| 和为零约束 | 模型不可识别 | MCMC 收敛稳定 |
| 特征排除 | 共线性导致系数反转 | 系数方向合理 |
| 训练集均值中心化 | 数据泄露 | 评估结果可靠 |
| Student-t 分布 | 异常值敏感 | 鲁棒性增强 |
| 交互项 | 无法捕捉复杂效应 | 准确率提升至 49.4% |
