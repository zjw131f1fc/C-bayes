# config.yaml

model:

  # 样条设置（从 X_obs_names 中选）
  spline_features: null
  n_spline_knots: 5
  spline_degree: 3

  # 排除的观测特征
  exclude_obs_features:
    - judge_save_active # 与 rule_method 高度负相关 (r=-0.931)
    - score_trend       # 与 z_score 共线性 (r=0.585)，导致系数反转
    - is_top_score      # 与 z_score 高度相关 (r=0.585)，系数方向不合理
    - perfect_score     # 与 z_score 相关 (r=0.283)，系数方向不合理
    - weeks_survived    # 周内不变，信息量低，不确定性大
    - season_era        # 周内不变，信息量低，不确定性大
    - rule_method       # 周内不变，信息量低，不确定性大

  # 排除的名人特征
  exclude_celeb_features:
    - age_centered      # 与 age 完全相同 (r=1.0)
    - age_squared       # 与 age 高度相关 (r=0.979)
    - age_bucket_old    # 与 age 高度相关 (r=0.738)
    - log_us_state_pop  # 用交互项替代

  # 名人特征交互项
  celeb_interaction_features:
    - "log_us_state_pop * (1 - is_international)"  # 只对美国选手有效

  # 观测特征交互项（测试后效果不佳，已禁用）
  obs_interaction_features: null

  # 特征中心化
  center_features: true

  # 正则化
  use_horseshoe: true

  # 似然函数
  tau_init: 1.0
  learn_tau: true

  # 约束
  sum_to_zero: true

prior:
  sigma_celeb: { a: 2.0, b: 1.0 }
  sigma_pro: { a: 2.0, b: 1.0 }
  beta_celeb_scale: 2.5
  beta_pro_scale: 2.5
  beta_obs_scale: 2.5
  spline_smoothing_scale: 1.0

sampling:
  n_chains: 4        # 4条链检验收敛
  n_tune: 1000       # 1000次预热
  n_samples: 2000    # 2000次正式采样
  target_accept: 0.9 # 目标接受率
  random_seed: 42
  cores: 4           # 并行核数

output:
  dir: outputs/model
  save_trace: true
